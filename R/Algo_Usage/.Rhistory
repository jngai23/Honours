control <- trainControl(method="cv", number=10,
summaryFunction=twoClassSummary,
classProbs=TRUE,
savePredictions = 'all',
allowParallel=TRUE)
tunegrid <- expand.grid(.mtry=candidates)
set.seed(seed)
#Trains the model on data using parameters set
metric <- "ROC"
set.seed(seed)
tunegrid <- expand.grid(.mtry=candidates)
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
#Plot and View Data
custom
#Predict on Test Set
predout = predict(custom, testset)
#Tests accuracy of model on the Test Set
length = length(testset$Toxicity_Value)
counts = 0
for (i in 1:length) {
if (testset$Toxicity_Value[i] == predout[i]) {
counts <- counts + 1
}
}
acc = counts/nrow(testset)
print(paste("Accuracy = ", acc))
#Determines Cohen's Kappa Coefficient of Model
postResample(pred = predout, obs = testset$Toxicity_Value)
#Converts Toxicity_Value Data back to numerical to calculate RMSE
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
binary_testset <- ifelse(testset$Toxicity_Value == 'T', 1, 0)
binary_preds <- ifelse(predout == 'T', 1, 0)
#Determines RMSE of model
RMSE <- rmse(binary_testset, binary_preds)
#Output all results to text
sink(file = 'output.txt')
print('from deepnormspedata.csv')
custom
postResample(pred = predout, obs = testset$Toxicity_Value)
print(paste("Accuracy = ", acc))
print(paste("RMSE = ", RMSE))
sink()
start.time <- Sys.time()
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
time.taken <- round(end.time - start.time,2)
start.time <- Sys.time()
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
end.time <- Sys.time()
time.taken <- round(end.time - start.time,2)
time.taken
#Sampling for testing
df <- sample_n(df[,2:(ncol(df))], 1000)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
#Convert Toxicity_Value into a factor for the algorithm
#Numerical Binary (1,0) values are also altered to Categorical (T, F)
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
df$Toxicity_Value = as.factor(df$Toxicity_Value)
#Creating test and train sets
testset <- df[-sampleset,]
trainset <- df[sampleset,]
x <- trainset#[,2:ncol(trainset)]
y <- trainset$Toxicity_Value
#Parameter setting
candidates = c(25, 50)
treecount = c(100)
#Testing a range of parameters
metric <- "Accuracy"
#Control tests for ROC, Sensitivity, Specificity
control <- trainControl(method="cv", number=10,
summaryFunction=twoClassSummary,
classProbs=TRUE,
savePredictions = 'all',
allowParallel=TRUE)
tunegrid <- expand.grid(.mtry=candidates)
set.seed(seed)
#Trains the model on data using parameters set
metric <- "ROC"
set.seed(seed)
tunegrid <- expand.grid(.mtry=candidates)
start.time <- Sys.time()
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
end.time <- Sys.time()
time.taken <- round(end.time - start.time,2)
time.taken
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
#Sampling for testing
df <- sample_n(df[,2:(ncol(df))], 1000)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
#Convert Toxicity_Value into a factor for the algorithm
#Numerical Binary (1,0) values are also altered to Categorical (T, F)
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
df$Toxicity_Value = as.factor(df$Toxicity_Value)
#Creating test and train sets
testset <- df[-sampleset,]
trainset <- df[sampleset,]
x <- trainset#[,2:ncol(trainset)]
y <- trainset$Toxicity_Value
#Parameter setting
candidates = c(25, 50)
treecount = c(100)
#Testing a range of parameters
metric <- "Accuracy"
#Control tests for ROC, Sensitivity, Specificity
control <- trainControl(method="cv", number=10,
summaryFunction=twoClassSummary,
classProbs=TRUE,
savePredictions = 'all',
allowParallel=TRUE)
tunegrid <- expand.grid(.mtry=candidates)
set.seed(seed)
#Trains the model on data using parameters set
metric <- "ROC"
set.seed(seed)
tunegrid <- expand.grid(.mtry=candidates)
start.time <- Sys.time()
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
#Sampling for testing
df <- sample_n(df[,2:(ncol(df))], 1000)
#Data Reading
df <- deepnormspedata
#Sampling for testing
df <- sample_n(df[,2:(ncol(df))], 1000)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
#Convert Toxicity_Value into a factor for the algorithm
#Numerical Binary (1,0) values are also altered to Categorical (T, F)
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
df$Toxicity_Value = as.factor(df$Toxicity_Value)
#Creating test and train sets
testset <- df[-sampleset,]
trainset <- df[sampleset,]
x <- trainset#[,2:ncol(trainset)]
y <- trainset$Toxicity_Value
#Parameter setting
candidates = c(25, 50)
treecount = c(100)
#Testing a range of parameters
metric <- "Accuracy"
#Control tests for ROC, Sensitivity, Specificity
control <- trainControl(method="cv", number=10,
summaryFunction=twoClassSummary,
classProbs=TRUE,
savePredictions = 'all',
allowParallel=TRUE)
tunegrid <- expand.grid(.mtry=candidates)
set.seed(seed)
#Trains the model on data using parameters set
metric <- "ROC"
set.seed(seed)
tunegrid <- expand.grid(.mtry=candidates)
start.time <- Sys.time()
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
end.time <- Sys.time()
time.taken <- round(end.time - start.time,2)
time.taken
library(readr)
deepnormspedata <- read_csv("datasets/deepnormspedata.csv")
View(deepnormspedata)
library(caret)
library(mlbench)
library(randomForest)
library(parallel)
library(doParallel)
library(dplyr)
library(Metrics)
library(pROC)
cl <- makePSOCKcluster(4)
seed <- 81
set.seed(seed)
#Data Reading
df <- deepnormspedata
#Sampling for testing
df <- sample_n(df[,2:(ncol(df))], 1000)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
#Convert Toxicity_Value into a factor for the algorithm
#Numerical Binary (1,0) values are also altered to Categorical (T, F)
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
df$Toxicity_Value = as.factor(df$Toxicity_Value)
#Creating test and train sets
testset <- df[-sampleset,]
trainset <- df[sampleset,]
x <- trainset#[,2:ncol(trainset)]
y <- trainset$Toxicity_Value
#Parameter setting
candidates = c(25, 50)
treecount = c(100)
#Testing a range of parameters
metric <- "Accuracy"
#Control tests for ROC, Sensitivity, Specificity
control <- trainControl(method="cv", number=10,
summaryFunction=twoClassSummary,
classProbs=TRUE,
savePredictions = 'all',
allowParallel=TRUE)
tunegrid <- expand.grid(.mtry=candidates)
set.seed(seed)
#Trains the model on data using parameters set
metric <- "ROC"
set.seed(seed)
tunegrid <- expand.grid(.mtry=candidates)
start.time <- Sys.time()
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
end.time <- Sys.time()
time.taken <- round(end.time - start.time,2)
time.taken
library(caret)
library(mlbench)
library(randomForest)
setwd("~/Documents/Honours/R/Algo_Usage")
library(readr)
autoencdata <- read_csv("datasets/autoencdata.csv")
View(autoencdata)
library(caret)
library(mlbench)
library(randomForest)
library(parallel)
library(doParallel)
library(dplyr)
library(Metrics)
library(pROC)
setwd("~/Documents/Honours/R/Algo_Usage")
cl <- makePSOCKcluster(4)
registerDoParallel(cl)
seed <- 81
set.seed(seed)
#Data Reading
autoencdata <- read_csv("datasets/autoencdata.csv")
#Sampling for testing
df <- sample_n(df[,2:(ncol(df))], 500)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
#Data Reading
autoencdata <- read_csv("datasets/autoencdata.csv")
#Sampling for testing
df <- sample_n(df[,1:(ncol(df))], 500)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
#Convert Toxicity_Value into a factor for the algorithm
#Numerical Binary (1,0) values are also altered to Categorical (T, F)
df$Toxicity_Value = as.factor(df$Toxicity_Value)
#Sampling for testing
df <- sample_n(df[,1:(ncol(df))], 500)
View9df
View(df)
#Data Reading
autoencdata <- read_csv("datasets/autoencdata.csv")
#Sampling for testing
df <- sample_n(df[], 500)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
#Data Reading
autoencdata <- read_csv("datasets/autoencdata.csv")
#Data Reading
df <- read_csv("datasets/autoencdata.csv")
#Sampling for testing
df <- sample_n(df[,2:(ncol(df))], 500)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
#Convert Toxicity_Value into a factor for the algorithm
#Numerical Binary (1,0) values are also altered to Categorical (T, F)
df$Toxicity_Value = as.factor(df$Toxicity_Value)
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
#Creating test and train sets
testset <- df[-sampleset,]
trainset <- df[sampleset,]
x <- trainset#[,2:ncol(trainset)]
y <- trainset$Toxicity_Value
#Parameter setting
candidates = c(5, 10, 50, 100, 250)
treecount = c(1000)
#Testing a range of parameters
metric <- "Accuracy"
#Control tests for ROC, Sensitivity, Specificity
control <- trainControl(method="cv", number=10,
summaryFunction=twoClassSummary,
classProbs=TRUE,
savePredictions = 'all',
allowParallel=TRUE)
tunegrid <- expand.grid(.mtry=candidates)
set.seed(seed)
#Trains the model on data using parameters set
metric <- "ROC"
set.seed(seed)
tunegrid <- expand.grid(.mtry=candidates)
start.time <- Sys.time()
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
end.time <- Sys.time()
time.taken <- round(end.time - start.time,2)
time.taken
#Plot and View Data
custom
#Predict on Test Set
predout = predict(custom, testset)
View(x)
#Predict on Test Set
predout = predict(custom, testset)
#Determines Cohen's Kappa Coefficient of Model
postResample(pred = predout, obs = testset$Toxicity_Value)
#Converts Toxicity_Value Data back to numerical to calculate RMSE
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
View(df)
binary_testset <- ifelse(testset$Toxicity_Value == 'T', 1, 0)
#Predict on Test Set
predout = predict(custom, testset)
View(testset)
View(x)
#Data Reading
df <- read_csv("datasets/autoencdata.csv")
#Sampling for testing
df <- sample_n(df[,2:(ncol(df))], 500)
View(df)
#Sampling for testing
df <- sample_n(df[,2:(ncol(df))], 500)
View(df)
#Data Reading
df <- read_csv("datasets/autoencdata.csv")
View(df)
#Sampling for testing
df <- sample_n(df[,3:(ncol(df))], 500)
View(df)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
#Convert Toxicity_Value into a factor for the algorithm
#Numerical Binary (1,0) values are also altered to Categorical (T, F)
df$Toxicity_Value = as.factor(df$Toxicity_Value)
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
#Creating test and train sets
testset <- df[-sampleset,]
trainset <- df[sampleset,]
x <- trainset#[,2:ncol(trainset)]
y <- trainset$Toxicity_Value
#Parameter setting
candidates = c(5, 10, 50, 100, 250)
treecount = c(1000)
#Testing a range of parameters
metric <- "Accuracy"
#Control tests for ROC, Sensitivity, Specificity
control <- trainControl(method="cv", number=10,
summaryFunction=twoClassSummary,
classProbs=TRUE,
savePredictions = 'all',
allowParallel=TRUE)
tunegrid <- expand.grid(.mtry=candidates)
set.seed(seed)
#Trains the model on data using parameters set
metric <- "ROC"
set.seed(seed)
tunegrid <- expand.grid(.mtry=candidates)
start.time <- Sys.time()
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
end.time <- Sys.time()
time.taken <- round(end.time - start.time,2)
time.taken
#Plot and View Data
custom
#Predict on Test Set
predout = predict(custom, testset)
#Tests accuracy of model on the Test Set
length = length(testset$Toxicity_Value)
counts = 0
for (i in 1:length) {
if (testset$Toxicity_Value[i] == predout[i]) {
counts <- counts + 1
}
}
acc = counts/nrow(testset)
print(paste("Accuracy = ", acc))
#Determines Cohen's Kappa Coefficient of Model
postResample(pred = predout, obs = testset$Toxicity_Value)
#Determines Cohen's Kappa Coefficient of Model
postResample(pred = predout, obs = testset$Toxicity_Value)
predout
View(testset)
View(predout)
#Predict on Test Set
predout = predict(custom, testset)
#Tests accuracy of model on the Test Set
length = length(testset$Toxicity_Value)
counts = 0
for (i in 1:length) {
if (testset$Toxicity_Value[i] == predout[i]) {
counts <- counts + 1
}
}
acc = counts/nrow(testset)
print(paste("Accuracy = ", acc))
#Determines Cohen's Kappa Coefficient of Model
postResample(pred = predout, obs = testset$Toxicity_Value)
postResample(pred = predout, obs = testset$Toxicity_Value)
testset$Toxicity_Value
predout
#Determines Cohen's Kappa Coefficient of Model
testset$Toxicity_Value = as.factor(testset$Toxicity_Value)
postResample(pred = predout, obs = testset$Toxicity_Value)
#Converts Toxicity_Value Data back to numerical to calculate RMSE
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
binary_testset <- ifelse(testset$Toxicity_Value == 'T', 1, 0)
binary_preds <- ifelse(predout == 'T', 1, 0)
#Determines RMSE of model
RMSE <- rmse(binary_testset, binary_preds)
#Output all results to text
sink(file = 'outputs/autoencdataRF.txt')
print('from autoencdata.csv')
print(paste("ntree = ", treecount))
print(paste("mtry = ", candidates))
custom
postResample(pred = predout, obs = testset$Toxicity_Value)
print(paste("Accuracy = ", acc))
print(paste("RMSE = ", RMSE))
print(time.taken)
sink()
#Data Reading, make sure to change for each set
df <- read_csv("datasets/UMAPdata.csv")
#Sampling for testing
df <- sample_n(df[,3:(ncol(df))], 500)
sampleset <- createDataPartition(df$Toxicity_Value, p=0.8, list=FALSE)
#Convert Toxicity_Value into a factor for the algorithm
#Numerical Binary (1,0) values are also altered to Categorical (T, F)
df$Toxicity_Value = as.factor(df$Toxicity_Value)
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
#Creating test and train sets
testset <- df[-sampleset,]
trainset <- df[sampleset,]
x <- trainset#[,2:ncol(trainset)]
y <- trainset$Toxicity_Value
#Parameter setting
#test mtry = 5, 10, 50, 100, 250, 500
candidates = c(5, 10, 50, 100, 250)
#test ntree = 500, 1000, 2500
treecount = c(1000)
#Testing a range of parameters
metric <- "Accuracy"
#Control tests for ROC, Sensitivity, Specificity
control <- trainControl(method="cv", number=10,
summaryFunction=twoClassSummary,
classProbs=TRUE,
savePredictions = 'all',
allowParallel=TRUE)
tunegrid <- expand.grid(.mtry=candidates)
set.seed(seed)
#Trains the model on data using parameters set
metric <- "ROC"
set.seed(seed)
tunegrid <- expand.grid(.mtry=candidates)
start.time <- Sys.time()
custom <- train(Toxicity_Value~., data=x, method="rf",
metric=metric, tuneGrid=tunegrid, trControl=control,
ntree=treecount, na.action = na.exclude)
custom
end.time <- Sys.time()
time.taken <- round(end.time - start.time,2)
time.taken
#Plot and View Data
custom
#Predict on Test Set
predout = predict(custom, testset)
#Tests accuracy of model on the Test Set
length = length(testset$Toxicity_Value)
counts = 0
for (i in 1:length) {
if (testset$Toxicity_Value[i] == predout[i]) {
counts <- counts + 1
}
}
acc = counts/nrow(testset)
print(paste("Accuracy = ", acc))
#Determines Cohen's Kappa Coefficient of Model
testset$Toxicity_Value = as.factor(testset$Toxicity_Value)
postResample(pred = predout, obs = testset$Toxicity_Value)
#Converts Toxicity_Value Data back to numerical to calculate RMSE
df$Toxicity_Value <- ifelse(df$Toxicity_Value == 1, "T", "F")
binary_testset <- ifelse(testset$Toxicity_Value == 'T', 1, 0)
binary_preds <- ifelse(predout == 'T', 1, 0)
#Determines RMSE of model
RMSE <- rmse(binary_testset, binary_preds)
#Output all results to text
#Change output file depending on inputs
sink(file = 'autoencdataRF.txt')
print('from autoencdata.csv')
print(paste("ntree = ", treecount))
print(paste("mtry = ", candidates))
custom
postResample(pred = predout, obs = testset$Toxicity_Value)
print(paste("Accuracy = ", acc))
print(paste("RMSE = ", RMSE))
print(time.taken)
sink()
View(x)
library(readr)
raw_dataset <- read_csv("~/Documents/Honours/Python/Target_Selection/Drug_Targets/raw_dataset.csv")
View(raw_dataset)
library(readr)
autoencdata <- read_csv("datasets/autoencdata.csv")
View(autoencdata)
library(readr)
processed_endo_data <- read_csv("~/Documents/oldHons/Data/processed_endo_data.csv")
View(processed_endo_data)
